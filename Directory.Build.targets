<Project>

  <PropertyGroup Condition="'$(GITHUB_ACTIONS)' == 'true'">
    <ContinuousIntegrationBuild>true</ContinuousIntegrationBuild>
  </PropertyGroup>

  <!-- In CI, only build Android on Linux to reduce build time. -->
  <Target Name="_AdjustTargetFrameworkItems" BeforeTargets="_ComputeTargetFrameworkItems">
    <PropertyGroup Condition="'$(ContinuousIntegrationBuild)' == 'true' And !$([MSBuild]::IsOSPlatform('Linux'))">
      <TargetFrameworks>$([MSBuild]::Unescape($(TargetFrameworks.Replace('net6.0-android',''))))</TargetFrameworks>
    </PropertyGroup>
  </Target>
  <PropertyGroup Condition="'$(ContinuousIntegrationBuild)' == 'true' And !$([MSBuild]::IsOSPlatform('Linux'))">
    <TargetFramework Condition="'$(TargetFramework)' == 'net6.0-android'"></TargetFramework>
  </PropertyGroup>

  <!--
    If we've not targeted anything, build an empty assembly instead of failing.
    For example, the iOS & macCatalyst sample apps only build on a Mac.
    Also, we skip Android targets on non-Linux machines in CI for faster build times.
  -->
  <PropertyGroup Condition="'$(TargetFramework)' == ''">
    <TargetFramework>net6.0</TargetFramework>
    <OutputType>Library</OutputType>
    <DefaultItemExcludes>**\*</DefaultItemExcludes>
  </PropertyGroup>

  <ItemGroup>
    <!-- Workaround the fact that http doesnt exist in earlier frameworks -->
    <Using Remove="System.Net.Http" />
    <Using Remove="System.Net.Http.Json" />
  </ItemGroup>
</Project>
