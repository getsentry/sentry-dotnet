<Project>
  <!--
  These are needed because we use project references in this solution.
  In an app that uses our nuget packages, they will come through the nuget packages automatically.
  -->
  <Import Project="$(MSBuildThisFileDirectory)..\src\Sentry\buildTransitive\Sentry.targets" />
  <Import Project="$(MSBuildThisFileDirectory)..\src\Sentry.Bindings.Cocoa\buildTransitive\Sentry.Bindings.Cocoa.targets"
    Condition="'$(OutputType)' == 'Exe' And ('$(TargetPlatformIdentifier)' == 'ios' Or '$(TargetPlatformIdentifier)' == 'maccatalyst')" />
  <Import Project="$(MSBuildThisFileDirectory)..\src\Sentry\Platforms\Native\buildTransitive\Sentry.Native.targets" />
  <Import Project="$(MSBuildThisFileDirectory)..\src\Sentry\buildTransitive\Sentry.SourceGenerators.targets" />

  <Target Name="GenerateSharedDsnConstant"
          BeforeTargets="BeforeCompile"
          Condition="'$(SENTRY_DSN)' != ''">

    <Message Text="Generating shared EnvironmentVariables.g.cs with embedded DSN..." Importance="High" />

    <WriteLinesToFile
      File="$(MSBuildThisFileDirectory)EnvironmentVariables.g.cs"
      Lines="
// This file is auto-generated by a custom build target used in the Sentry Samples... in your own projects you should
// specify the DSN either directly in code (in the file where you initialize Sentry) or via SENTRY_DSN environment
// variable (for non-mobile projects - that won't work on Android, iOS, or MacCatalyst).
namespace Sentry.Samples%3B

internal static class EnvironmentVariables
{
    /// &lt;summary&gt;
    /// To make things easier for the SDK maintainers, we have a custom build target that writes the
    /// SENTRY_DSN environment variable into an EnvironmentVariables class that is available for mobile
    /// targets. This allows us to share one DSN defined in the ENV across desktop and mobile samples.
    /// Generally, you won't want to do this in your own mobile projects though - you should set the DSN
    /// in code as above
    /// &lt;/summary&gt;
    internal const string Dsn = &quot;$(SENTRY_DSN)&quot;%3B
}
"
      Overwrite="true" />
  </Target>

  <ItemGroup>
    <!-- Make sure all sample projects include the generated file -->
    <Compile Include="$(MSBuildThisFileDirectory)EnvironmentVariables.g.cs" Condition="Exists('$(MSBuildThisFileDirectory)EnvironmentVariables.g.cs')" />
    <!-- Make sure all sample projects include any other shared files -->
    <Compile Include="$(MSBuildThisFileDirectory)SamplesShared.cs" />

    <!-- Add shared global usings   -->
    <Using Include="Sentry.Samples" />
  </ItemGroup>

</Project>
