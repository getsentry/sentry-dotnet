<Project>

  <PropertyGroup>
    <SupportedOSPlatformVersion>21</SupportedOSPlatformVersion>
    <!-- BG8605 and BG8606 happen because there's a missing androidx.lifecycle dependency, but we don't need it here.  (The native Android Sentry SDK will use it if it exists.) -->
    <NoWarn>$(NoWarn);BG8605;BG8606</NoWarn>
    <SentryAndroidSdkVersion>6.0.0</SentryAndroidSdkVersion>
    <AndroidLibsDirectory>$(BaseIntermediateOutputPath)\SentrySDKs\Android\$(SentryAndroidSdkVersion)\</AndroidLibsDirectory>
    <LangVersion>10</LangVersion>
    <ImplicitUsings>true</ImplicitUsings>
  </PropertyGroup>

  <ItemGroup>
    <None Remove="Android/Transforms/*.xml" />
    <TransformFile Include="Android/Transforms/*.xml" />
    <!-- TODO: How to add JavaDocPaths for each package? -->
    <AndroidLibrary Include="$(AndroidLibsDirectory)sentry-$(SentryAndroidSdkVersion).jar" />
    <AndroidLibrary Include="$(AndroidLibsDirectory)sentry-android-core-$(SentryAndroidSdkVersion).aar" />
    <AndroidLibrary Include="$(AndroidLibsDirectory)sentry-android-ndk-$(SentryAndroidSdkVersion).aar" />
  </ItemGroup>

  <ItemGroup>
    <Compile Include="Android/**/*.cs" />
  </ItemGroup>

  <ItemGroup>
    <Using Include="System.Globalization" />
    <Using Include="System.Text.Json" />
    <Using Include="Android.Runtime" />
    <Using Include="Android.Content.Context" Alias="AndroidContext" />
    <Using Include="Android.OS.Build" Alias="AndroidBuild" />
    <Using Include="Java.Lang.Boolean" Alias="JavaBoolean" />
    <Using Include="Java.Lang.Class" Alias="JavaClass" />
    <Using Include="Java.Lang.Double" Alias="JavaDouble" />
    <Using Include="Java.Lang.Enum" Alias="JavaEnum" />
    <Using Include="Java.Lang.Integer" Alias="JavaInteger" />
    <Using Include="Java.Lang.Long" Alias="JavaLong" />
    <Using Include="Java.Lang.Object" Alias="JavaObject" />
    <Using Include="Java.Lang.Throwable" Alias="Throwable" />
    <Using Include="Java.IO.InputStreamReader" Alias="JavaInputStreamReader" />
    <Using Include="Java.IO.OutputStreamWriter" Alias="JavaOutputStreamWriter" />
    <Using Include="Java.Util.Date" Alias="JavaDate" />
  </ItemGroup>

  <Target Name="DownloadSentryAndroidSdk" BeforeTargets="CollectPackageReferences">
    <DownloadFile SourceUrl="https://repo1.maven.org/maven2/io/sentry/sentry-android-core/$(SentryAndroidSdkVersion)/sentry-android-core-$(SentryAndroidSdkVersion).aar"
      DestinationFolder="$(AndroidLibsDirectory)"
      Condition="!Exists('$(AndroidLibsDirectory)sentry-android-core-$(SentryAndroidSdkVersion).aar')">
      <Output TaskParameter="DownloadedFile" ItemName="None" />
    </DownloadFile>
    <DownloadFile SourceUrl="https://repo1.maven.org/maven2/io/sentry/sentry-android-ndk/$(SentryAndroidSdkVersion)/sentry-android-ndk-$(SentryAndroidSdkVersion).aar"
      DestinationFolder="$(AndroidLibsDirectory)"
      Condition="!Exists('$(AndroidLibsDirectory)sentry-android-ndk-$(SentryAndroidSdkVersion).aar')">
      <Output TaskParameter="DownloadedFile" ItemName="None" />
    </DownloadFile>
    <DownloadFile SourceUrl="https://repo1.maven.org/maven2/io/sentry/sentry/$(SentryAndroidSdkVersion)/sentry-$(SentryAndroidSdkVersion).jar"
      DestinationFolder="$(AndroidLibsDirectory)"
      Condition="!Exists('$(AndroidLibsDirectory)sentry-$(SentryAndroidSdkVersion).jar')">
      <Output TaskParameter="DownloadedFile" ItemName="None" />
    </DownloadFile>
  </Target>

</Project>
