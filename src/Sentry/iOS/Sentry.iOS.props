<Project>

  <PropertyGroup>
    <LangVersion>10</LangVersion>
    <ImplicitUsings>true</ImplicitUsings>
    <SupportedOSPlatformVersion>13.0</SupportedOSPlatformVersion>
    <IsBindingProject>true</IsBindingProject>
    <!-- default is true: -->
    <NoBindingEmbedding>false</NoBindingEmbedding>
    <SentryCocoaSdkVersion>7.17.0</SentryCocoaSdkVersion>
    <!-- Don't remove native symbols, because it makes debugging native crashes harder -->
    <MtouchNoSymbolStrip>true</MtouchNoSymbolStrip>
    <iOSLibsDirectory>$(BaseIntermediateOutputPath)/SentrySDKs/iOS/$(SentryCocoaSdkVersion)/</iOSLibsDirectory>
    <iOSFramework>$(iOSLibsDirectory)Sentry.xcframework/Carthage/Build/Sentry.xcframework</iOSFramework>
  </PropertyGroup>

  <ItemGroup>
    <Compile Include="iOS/**/*.cs" />
  </ItemGroup>

  <ItemGroup>
    <ObjcBindingApiDefinition Include="iOS/ApiDefinition.cs" />
    <ObjcBindingCoreSource Include="iOS/Structs.cs" />
    <NativeReference Include="$(iOSFramework)" Kind="Framework" />
  </ItemGroup>

  <ItemGroup>
    <Using Include="System.Globalization" />
    <Using Include="System.Text.Json" />
  </ItemGroup>

  <Target Name="DownloadSentryCocoaSdk" BeforeTargets="CollectPackageReferences">
    <DownloadFile SourceUrl="https://github.com/getsentry/sentry-cocoa/releases/download/$(SentryCocoaSdkVersion)/Sentry.xcframework.zip"
      DestinationFolder="$(iOSLibsDirectory)"
      Condition="!Exists('$(iOSLibsDirectory)Sentry.xcframework.zip')">
      <Output TaskParameter="DownloadedFile" ItemName="None" />
    </DownloadFile>
    <Unzip
        SourceFiles="$(iOSLibsDirectory)Sentry.xcframework.zip"
        DestinationFolder="$(iOSLibsDirectory)Sentry.xcframework"
        OverwriteReadOnlyFiles="true"
    />
  </Target>

</Project>
